# Построение ETL-пайплайна. Автоматизация ежедневной обработки и загрузки данных.

## Входные данные:
В приложении есть два сервиса: лента новостей и мессенджер. Данные о действиях пользователей из каждого сервиса записываются в базу данных Clickhouse в отдельные таблицы:  **feed_actions** и **message_actions** соответственно. 

#### Таблица feed_actions (лента новостей):
- user_id - id пользователя
- post_id - id поста
- action - действие пользователя (просмотр или лайк)
- time - время совершения действия
- gender - пол
- age - возраст
- country - страна
- city - город
- os - операционная система
- source - источник, откуда пришел пользователь
- exp_group - номер эксперимантальной группы

#### Таблица message_actions (мессенджер):
- user_id - id отправителя
- receiver_id - id получателя
- time - время совершения действия
- gender - пол
- age - возраст
- country - страна
- city - город
- os - операционная система
- source - источник, откуда пришел пользователь
- exp_group - номер эксперимантальной группы

## Задача:   
В feed_actions для каждого юзера посчитаем число просмотров и лайков контента. В message_actions для каждого юзера считаем, сколько он получает и отсылает сообщений, скольким людям он пишет, сколько людей пишут ему. Каждая выгрузка должна быть в отдельном таске.
2. Далее объединяем две таблицы в одну.

3. Для этой таблицы считаем все эти метрики в разрезе по полу, возрасту и ос. Делаем три разных таска на каждый срез.

4. И финальные данные со всеми метриками записываем в отдельную таблицу в ClickHouse.

5. Каждый день таблица должна дополняться новыми данными. 

Структура финальной таблицы должна быть такая:

Дата - event_date

Название среза - dimension

Значение среза - dimension_value

Число просмотров - views

Число лайков - likes

Число полученных сообщений - messages_received

Число отправленных сообщений - messages_sent

От скольких пользователей получили сообщения - users_received

Скольким пользователям отправили сообщение - users_sent

Срез — это os, gender и age

Вашу таблицу необходимо загрузить в схему test, ответ на это задание — название вашей таблицы в схеме test.
